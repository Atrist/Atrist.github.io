# 原型基础
## 原型对象
每个对象都有一个原型`prototype`对象，通过函数创建的对象也将拥有这个原型对象。

原型是一个指向对象的指针。
- 可以将原型理解为对象的父亲，对象从原型对象继承来属性
- 原型就是对象除了是某个对象的父母外没有什么特别之处
- 所有函数的原型默认是 `Object`的实例，所以可以使用`toString/toValues/isPrototypeOf` 等方法的原因
- 使用原型对象为多个对象共享属性或方法
- 如果对象本身不存在属性或方法将到原型上查找
- 使用原型可以解决，通过构建函数创建对象时复制多个函数造成的内存占用问题
- 原型包含 constructor 属性，指向构造函数
- 对象包含 `__proto__` 指向他的原型对象

下例使用的就是数组原型对象的 `concat` 方法完成的连接操作
```js
let hd = ["a"];
console.log(hd.concat("b"));
console.log(hd);
```
默认情况下创建的对象都有原型
```js
let hd = { name: "后盾人" };
console.log(hd);
```
以下x、y的原型都为元对象Object，即JS中的根对象
```js
let x = {};
let y = {};
console.log(Object.getPrototypeOf(x) == Object.getPrototypeOf(y)); //true
```
我们也可以创建一个极简对象（纯数据字典对象）没有原型（原型为null)
```js
let hd = { name: 3 };
console.log(hd.hasOwnProperty("name"));

let xj = Object.create(null, {
  name: {
    value: "向军"
  }
});
console.log(xj.hasOwnProperty("name")); //Error

//Object.keys是静态方法，不是原型方法所以是可以使用的
console.log(Object.keys(xj));
```
函数拥有多个原型，`prototype` 用于实例对象使用，`__proto__`用于函数对象使用
```js
function User() {}
User.__proto__.view = function() {
  console.log("User function view method");
};
User.view();

User.prototype.show = function() {
  console.log("后盾人");
};
let hd = new User();
hd.show();
console.log(User.prototype == hd.__proto__);
```
下面是原型关系分析，与方法继承的示例

![](http://houdunren.gitee.io/note/assets/img/image-20191208003927158.2f7f84ab.png)

```js
let hd = new Object();
hd.name = "后盾人";
Object.prototype.show = function() {
  console.log("hodunren.com");
};
hd.show();

function User() {}
let xj = new User();
xj.show();
User.show();
```
下面是使用构造函数创建对象的原型体现

- 构造函数拥有原型
- 创建对象时构造函数把原型赋予对象

![](http://houdunren.gitee.io/note/assets/img/image-20191010023843179.58edd59f.png)
```js
function User() {}
let xj = new User();
console.log(xj.__proto__ == User.prototype);
```
下面使用数组会产生多级继承继原型链
![](http://houdunren.gitee.io/note/assets/img/image-20191120174145258.aec2cd6d.png)
```js
let hd = [];
console.log(hd);
console.log(hd.__proto__ == Array.prototype);

let str = "";
console.log(str.__proto__ == String.prototype);
```
下面使用 `setPrototypeOf` 与 `getPrototypeOf` 设置与获取原型
```js
let hd = {};
let parent = { name: "parent" };
Object.setPrototypeOf(hd, parent);
console.log(hd);
console.log(Object.getPrototypeOf(hd));
```
使用自定义构造函数创建的对象的原型体现

![](http://houdunren.gitee.io/note/assets/img/image-20191120174956195.700031e6.png)

```js
function User() {}
let hd = new User();
console.log(hd);

```
`constructor`存在于`prototype`原型中，用于指向构建函数的引用。
```js
function hd() {
  this.show = function() {
    return "show method";
  };
}
const obj = new hd(); //true
console.log(obj instanceof hd);

const obj2 = new obj.constructor();
console.dir(obj2.show()); //show method
```
