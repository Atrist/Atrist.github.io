## 双机备份
### 1. 双机部署提升网络可靠性
如左下图所示，防火墙部署在企业网络出口处，内外网之间的业务都会通过防火墙转发。如果防火墙出现故障，便会导致内外网之间的业务全部中断。由此可见，在这种网络关键位置上如果只使用一台设备的话，无论其可靠性多高，我们都必然要承受因设备单点故障而导致网络中断的风险。于是，我们在网络架构设计时，通常会在网络的关键位置部署两台（双机）或多台设备，以提升网络的可靠性。如右下图所示，当一台防火墙出现故障时，流量会通过另外一台防火墙所在的链路转发，保证内外网之间业务正常运行。

![](../images/5476c67e3ab27.png)

### 2. 路由器的双机部署只需考虑路由备份
如果是传统的网络转发设备（如路由器、三层交换机），只需要在两台设备上做好路由的备份就可以保证业务的可靠性。因为普通的路由器、交换机不会记录报文的交互状态和应用层信息，只是根据路由表进行报文转发，下面举个例子来说明。

如下图所示，两台路由器R1和R2与上下行设备R3和R4之间运行OSPF协议。正常情况下，由于以太网接口的缺省OSPF Cost值为1，所以在R3上看R1所在链路（R3―>R1―>R4―>FTP服务器）的Cost值为3。而由于我们在R2链路（R3―>R2―>R4―>FTP服务器）的各接口上将OSPF Cost值设置为10，所以在R3上看R2所在链路的Cost值为21。由于流量只会通过Cost值小的链路转发，所以FTP客户端与服务器间的业务就都只会通过R1转发。

![](../images/5476c69055f1c.png)

